import * as admin from 'firebase-admin'
import * as tadmin from '@firebase/testing'

const fb_ = () => admin.firestore()
let temp;
if (process.env.isRafasTest || checkForJest()) {
  const app = tadmin.initializeTestApp({projectId: "rumpelstiltskin-8cadf"})
  temp = app.firestore()
} else {
  admin.initializeApp()
temp = admin.firestore()
}
export const db: ReturnType<typeof fb_> = temp

function checkForJest() {
  try {
    if(jest) return jest
  } catch {
    return null
  }
  return null
}
